# 紅巨星救援計畫（Solar Rescue）— 遊戲說明

你是星際救援隊，太陽即將成為紅巨星。每一關代表一顆行星，目標是以**繞行**方式貼近圓周上的小生物，成功載走即得分並回收**星艦能源**。

---

## 操作
- **拉弓式發射**：按下=發射點，往後拉=速度，放開=發射（方向為**反向**）。
- 可**多重發射**。每發射一次消耗 2 點能源，救援成功 +10 點。能源為 0 立即結束。

## 規則
- 生物沿**行星圓周**移動。
- 太空梭若**切線**進入行星附近，可形成繞行；靠近生物即完成救援。
- 若撞擊行星，會造成生物死亡（依撞擊速度）。
- 本關所有生物清空時：若至少救到 1 隻 → 下一關，否則失敗。

---

## 提高「像人造衛星一樣一直繞行」的做法（本版已實作）

為了讓玩家更容易做出穩定繞行，我們在物理引擎內加入以下設計：

1. **重力半徑補償與強化**
   - 重力常數 `G_CONST` 提升，並以「地球半徑」為基準對不同行星半徑做**補償**：  
     `mu = G_CONST * g * (EARTH_R / planet.r)`  
     讓像水星這樣的小半徑行星，也能明顯拉彎軌跡。

2. **軟化核心（softening）**
   - 在計算 `a = mu / (r^2 + soft^2)` 時加入 `soft = (0.25 * R_planet)^2`，避免近地時重力過大直接吸死，有助於「貼近表面」但仍能**滑過去形成繞行**。

3. **子步進整合（Substeps）**
   - 每一幀將物理切成多個小時間步（例如 5 次），使得引力與阻力積分更**平滑且穩定**，減少數值爆震。

4. **降低阻力（Drag）**
   - 將線性阻力係數降低（不同行星基礎 drag 再乘以 0.4），讓飛船速度不會過早被吃掉，給重力更多時間改變**方向與速度**。

5. **切線化 + 圓軌速度輔助（Orbit Assist）**
   - 當飛船進入「近行星環帶」時，會以小係數 `blend`**將速度朝切線方向微調**，並**朝目標圓軌速度靠攏**：  
     ```text
     v_circ = sqrt(mu / r)
     v_target = v_circ * t_hat   // t_hat 為切線單位向量（依角動量方向決定正負）
     v ← mix(v, v_target, blend*dt)
     ```
   - 這相當於**微型姿態控制**（非瞬間鎖軌），可顯著提高穩定繞行機率，同時保留手感與失敗可能性。

6. **更寬鬆的「入軌判定」**
   - 降低「近切線」角度門檻、放寬可視為近軌道的半徑帶寬，並縮短穩定時間要求，提升「被認定為繞行」的機會。

7. **向量可視化（選用）**
   - 介面提供「顯示向量」：白色是**速度向量**、紅色是**重力方向**，方便觀察繞行過程。

---

## 參數建議（若你想微調）
- `G_CONST`（重力強度）
- `planet.drag`（阻力）
- `soft`（軟化核心大小）
- `blend`（切線化混合係數）
- 入軌判定：`nearT`、`nearBand`、`_orbitTimer` 門檻

如需把這些參數做成 UI 滑桿，也可以加上設定面板。

---

## 檔案結構
- `index.html`（本遊戲）
- `readme.md`（本說明）

在遊戲中按下「**遊戲說明 📖**」按鈕，會以 `fetch('readme.md')` 載入並顯示這個檔案。

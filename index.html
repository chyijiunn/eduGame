<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>科學小遊戲實驗室 | Science Mini Games</title>
  <meta name="description" content="科學網頁遊戲入口：搜尋、分類、年級、排序；支援深色模式與鍵盤操作。">
  <meta name="theme-color" content="#0ea5e9" />
  <style>
    :root {
      --bg:#0b1020; --panel:#0f172a; --muted:#cbd5e1; --text:#e5e7eb;
      --brand:#0ea5e9; --brand-2:#22d3ee; --chip:#1f2937; --chip-active:#0ea5e9;
      --shadow:0 10px 30px rgba(0,0,0,.35); --radius:14px;
    }
    @media (prefers-color-scheme: light){
      :root{--bg:#f8fafc;--panel:#fff;--muted:#475569;--text:#0f172a;--chip:#e2e8f0;--chip-active:#0ea5e9;--shadow:0 10px 25px rgba(2,6,23,.08)}
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Noto Sans TC,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
      background:radial-gradient(1200px 500px at 80% -50%, rgba(14,165,233,.25), transparent 60%),radial-gradient(900px 450px at -10% 0%, rgba(34,211,238,.20), transparent 60%),var(--bg);
      color:var(--text);line-height:1.6}
    a{color:inherit;text-decoration:none}
    .wrap{max-width:1180px;margin:0 auto;padding:24px}
    header.hero{display:grid;gap:20px;padding:28px;background:linear-gradient(180deg,rgba(255,255,255,.06),rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.08);border-radius:24px;box-shadow:var(--shadow);position:relative;overflow:hidden;isolation:isolate}
    .brand{display:flex;align-items:center;gap:12px}
    .brand .logo{width:44px;height:44px;border-radius:12px;flex:none;background:linear-gradient(135deg,var(--brand),var(--brand-2));
      display:grid;place-items:center;color:white;font-weight:800;box-shadow:0 12px 24px rgba(14,165,233,.35)}
    .brand h1{margin:0;font-size:clamp(22px,4vw,28px)}
    .brand p{margin:0;color:var(--muted)}
    .controls{display:grid;gap:14px}
    @media (min-width:800px){.controls{grid-template-columns:1.2fr .8fr .8fr;align-items:center}}
    .search{display:flex;align-items:center;gap:12px;background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:10px 14px}
    .search input{flex:1;border:0;outline:0;font-size:16px;background:transparent;color:var(--text)}
    .select{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .select select{width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.10);background:var(--panel);color:var(--text)}
    .chips{display:flex;gap:10px;flex-wrap:wrap}
    .chip{border-radius:999px;padding:8px 14px;border:1px solid rgba(255,255,255,.10);background:var(--chip);color:var(--text);cursor:pointer;font-size:14px}
    .chip[aria-pressed="true"]{background:var(--chip-active);color:#fff;border-color:transparent}
    .chip:focus-visible{outline:2px solid var(--brand-2);outline-offset:2px}
    .grid{display:grid;grid-template-columns:repeat(1,1fr);gap:18px;margin-block:24px 12px}
    @media (min-width:640px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (min-width:980px){.grid{grid-template-columns:repeat(3,1fr)}}
    .card{display:grid;grid-template-rows:auto 1fr auto;background:var(--panel);border:1px solid rgba(255,255,255,.08);border-radius:var(--radius);
      box-shadow:var(--shadow);overflow:hidden;transition:transform .15s ease,box-shadow .2s ease;min-height:280px}
    .card:hover{transform:translateY(-2px);box-shadow:0 16px 40px rgba(0,0,0,.35)}
    .thumb{aspect-ratio:16/9;background:linear-gradient(135deg, rgba(14,165,233,.25), rgba(34,211,238,.15));display:grid;place-items:center;position:relative}
    .thumb svg{width:58%;height:58%;opacity:.9}
    .badge{position:absolute;top:10px;left:10px;background:rgba(15,23,42,.65);color:#fff;padding:6px 10px;border-radius:999px;font-size:12px;
      backdrop-filter:blur(6px);border:1px solid rgba(255,255,255,.12)}
    .body{padding:14px 16px;display:grid;gap:6px}
    .title{font-weight:700;font-size:18px}
    .meta{color:var(--muted);font-size:13px}
    .tags{display:flex;gap:8px;flex-wrap:wrap;margin-top:6px}
    .tag{font-size:12px;padding:3px 8px;border-radius:999px;background:rgba(14,165,233,.14);color:#7dd3fc;border:1px solid rgba(125,211,252,.35)}
    .actions{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-top:1px solid rgba(255,255,255,.08)}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--brand-2));
      color:white;border:0;cursor:pointer;font-weight:700;box-shadow:0 12px 24px rgba(14,165,233,.35)}
    .btn.secondary{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,.12);box-shadow:none}
    footer{margin:36px 0 12px;color:var(--muted);font-size:14px;text-align:center}
    footer a{text-decoration:underline;text-underline-offset:3px}
    dialog[open]{border:0;border-radius:16px;padding:0;width:min(680px,96vw);background:var(--panel);color:var(--text)}
    .modal-body{padding:18px 20px}
    .modal-head{display:flex;justify-content:space-between;align-items:center;padding:14px 20px;border-bottom:1px solid rgba(255,255,255,.1)}
    .modal-head h3{margin:0;font-size:18px}
    .x{background:transparent;border:0;font-size:22px;color:var(--muted);cursor:pointer}
    .empty{padding:30px;text-align:center;color:var(--muted);border:1px dashed rgba(255,255,255,.2);border-radius:12px}
  </style>
</head>
<body>
  <div class="wrap">
    <header class="hero" role="banner">
      <div class="brand">
        <div class="logo" aria-hidden="true">S</div>
        <div>
          <h1>科學小遊戲實驗室</h1>
          <p>把你的科學網頁遊戲放上 GitHub Pages，從這裡統一進入、搜尋與分類。</p>
        </div>
      </div>

      <div class="controls" role="search">
        <label class="search" aria-label="搜尋遊戲">
          <svg aria-hidden="true" width="20" height="20" viewBox="0 0 24 24" fill="none"><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/><path d="M21 21l-4.3-4.3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
          <input id="q" type="search" placeholder="搜尋遊戲名稱、關鍵詞或標籤…" autocomplete="off" />
        </label>
        <div class="select">
          <select id="sort" aria-label="排序">
            <option value="recent">最近更新</option>
            <option value="popular">熱門程度</option>
            <option value="name">名稱 A→Z</option>
          </select>
          <select id="grade" aria-label="年級">
            <option value="all">所有年級</option>
            <option value="elem">國小</option>
            <option value="junior">國中</option>
            <option value="senior">高中</option>
          </select>
        </div>
        <div class="chips" role="toolbar" aria-label="學科分類">
          <button class="chip" data-cat="physics" aria-pressed="false">物理</button>
          <button class="chip" data-cat="chemistry" aria-pressed="false">化學</button>
          <button class="chip" data-cat="biology" aria-pressed="false">生物</button>
          <button class="chip" data-cat="earth" aria-pressed="false">地科</button>
          <button class="chip" data-cat="math" aria-pressed="false">數學</button>
          <button class="chip" data-cat="cs" aria-pressed="false">資科</button>
        </div>
      </div>
    </header>

    <main id="games" class="grid" aria-live="polite"></main>
    <div id="empty" class="empty" hidden>找不到符合條件的遊戲，請調整搜尋或分類。</div>

    <footer>
      <p>© <span id="year"></span> 科學小遊戲實驗室 · 以 <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> 部署 · Made with ♥</p>
    </footer>
  </div>

  <dialog id="modal">
    <div class="modal-head">
      <h3 id="modalTitle">遊戲資訊</h3>
      <button class="x" aria-label="關閉" onclick="modal.close()">×</button>
    </div>
    <div class="modal-body"><div id="modalContent"></div></div>
  </dialog>

  <script>
    const GAME_LIST = [
      {"id":"quarto_element","name":"化學元素四連戰","url":"games/quarto-element/","desc":"找出相同特徵一連線就成功","cats":["chemistry"],"grade":"junior","tags":["週期表","元素"],"updatedAt":"2025-10-01","hot":86},
      {"id":"pendulum","name":"單擺模擬器","url":"games/pendulum/","desc":"調整線長與重力，觀察週期變化，練習 T = 2π√(L/g)。","cats":["physics"],"grade":"junior","tags":["週期","重力加速度","模擬"],"updatedAt":"2025-09-25","hot":86},
      {"id":"stoichiometry","name":"配平化學方程式","url":"games/chem-balance/","desc":"從簡單到進階的反應式配平，含提示與檢查機制。","cats":["chemistry"],"grade":"junior","tags":["反應式","守恆","練習"],"updatedAt":"2025-09-12","hot":120},
      {"id":"diffusion","name":"擴散與滲透","url":"games/diffusion-osmosis/","desc":"建置濃度差與半透膜，觀察粒子移動與細胞體積變化。","cats":["biology"],"grade":"junior","tags":["濃度","半透膜","細胞"],"updatedAt":"2025-09-21","hot":74},
      {"id":"orbits","name":"行星軌道沙盒","url":"games/orbits/","desc":"用滑鼠丟出行星，嘗試畫出橢圓/拋物線/雙曲線軌道。","cats":["physics","earth","cs"],"grade":"senior","tags":["萬有引力","橢圓軌道","數值模擬"],"updatedAt":"2025-09-28","hot":210},
      {"id":"primes","name":"質因數城市","url":"games/prime-city/","desc":"分解大樓編號，蒐集公因、公倍與最大公因數、最小公倍數。","cats":["math"],"grade":"elem","tags":["公因數","最小公倍數","遊戲化"],"updatedAt":"2025-09-18","hot":95},
      {"id":"lymph","name":"淋巴圍城","url":"games/lymph-sys/","desc":"利用抗體、淋巴結腫大來對抗入侵的病原體。","cats":["biology"],"grade":"junior","tags":["淋巴","免疫"],"updatedAt":"2025-10-04","hot":200}
    ];

    const ICONS = {
      physics:`<svg viewBox='0 0 64 64' fill='none' aria-hidden='true'><circle cx='32' cy='10' r='6' stroke='currentColor' stroke-width='3'/><path d='M32 16v22' stroke='currentColor' stroke-width='3' stroke-linecap='round'/><circle cx='18' cy='50' r='6' stroke='currentColor' stroke-width='3'/><circle cx='46' cy='50' r='6' stroke='currentColor' stroke-width='3'/><path d='M18 44c2-12 26-12 28 0' stroke='currentColor' stroke-width='3' stroke-linecap='round'/></svg>`,
      chemistry:`<svg viewBox='0 0 64 64' fill='none' aria-hidden='true'><path d='M22 12v12l-12 18a6 6 0 0 0 5 9h34a6 6 0 0 0 5-9L42 24V12' stroke='currentColor' stroke-width='3' fill='none'/><path d='M20 28h24' stroke='currentColor' stroke-width='3'/><circle cx='24' cy='40' r='3' fill='currentColor'/><circle cx='32' cy='40' r='3' fill='currentColor'/><circle cx='40' cy='40' r='3' fill='currentColor'/></svg>`,
      biology:`<svg viewBox='0 0 64 64' fill='none' aria-hidden='true'><ellipse cx='32' cy='32' rx='24' ry='16' stroke='currentColor' stroke-width='3'/><circle cx='26' cy='32' r='6' stroke='currentColor' stroke-width='3'/><path d='M10 32h44' stroke='currentColor' stroke-width='3' stroke-dasharray='4 4'/></svg>`,
      earth:`<svg viewBox='0 0 64 64' fill='none' aria-hidden='true'><circle cx='32' cy='32' r='22' stroke='currentColor' stroke-width='3'/><path d='M10 30c6-6 16-10 22-8 6 2 14 2 20-2M12 38c8 2 10-4 18 0s12 6 22 4' stroke='currentColor' stroke-width='3'/></svg>`,
      math:`<svg viewBox='0 0 64 64' fill='none' aria-hidden='true'><path d='M12 20h16M20 12v16M36 12h16M36 28h16M44 20v-8' stroke='currentColor' stroke-width='3' stroke-linecap='round'/><path d='M12 44h16M12 52h16' stroke='currentColor' stroke-width='3' stroke-linecap='round'/></svg>`,
      cs:`<svg viewBox='0 0 64 64' fill='none' aria-hidden='true'><rect x='8' y='12' width='48' height='36' rx='4' stroke='currentColor' stroke-width='3'/><path d='M20 26l-8 6 8 6M44 26l8 6-8 6' stroke='currentColor' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'/></svg>`
    };

    const $grid=document.getElementById('games');
    const $empty=document.getElementById('empty');
    const $q=document.getElementById('q');
    const $sort=document.getElementById('sort');
    const $grade=document.getElementById('grade');
    const $year=document.getElementById('year');
    const modal=document.getElementById('modal');
    const $modalTitle=document.getElementById('modalTitle');
    const $modalContent=document.getElementById('modalContent');
    $year.textContent=new Date().getFullYear();

    const state={q:"",cats:new Set(),sort:"recent",grade:"all"};

    document.querySelectorAll('.chip').forEach(chip=>{
      chip.addEventListener('click',()=>{
        const c=chip.dataset.cat;
        const active=chip.getAttribute('aria-pressed')==='true';
        chip.setAttribute('aria-pressed',String(!active));
        if(active) state.cats.delete(c); else state.cats.add(c);
        render();
      });
    });
    $q.addEventListener('input',()=>{state.q=$q.value.trim().toLowerCase();render();});
    $sort.addEventListener('change',()=>{state.sort=$sort.value;render();});
    $grade.addEventListener('change',()=>{state.grade=$grade.value;render();});

    function pickIcon(cats){ for(const c of cats) if(ICONS[c]) return ICONS[c]; return ICONS.physics; }
    function formatDate(s){ if(!s) return "—"; const d=new Date(s+"T00:00:00"); const y=d.getFullYear(); const m=String(d.getMonth()+1).padStart(2,'0'); const da=String(d.getDate()).padStart(2,'0'); return `${y}/${m}/${da}`; }
    function catName(c){ return ({physics:"物理",chemistry:"化學",biology:"生物",earth:"地科",math:"數學",cs:"資科"})[c]||c; }
    function gradeName(g){ return ({elem:"國小",junior:"國中",senior:"高中"})[g]||"所有"; }

    function openModal(g){
      $modalTitle.textContent=g.name;
      $modalContent.innerHTML=`
        <p style="margin-top:0;color:var(--muted)">ID：<code>${g.id}</code></p>
        <p>${g.desc}</p>
        <p><strong>分類：</strong>${g.cats.map(catName).join('、')} · <strong>年級：</strong>${gradeName(g.grade)}</p>
        <p><strong>標籤：</strong>${(g.tags||[]).join('、')||"—"}</p>
        <p><strong>更新日期：</strong>${formatDate(g.updatedAt)} · <strong>熱門：</strong>${g.hot ?? "—"}</p>
        <p><a href="${g.url}" target="_blank" rel="noopener">前往遊戲</a></p>
        <hr style="border-color: rgba(255,255,255,.12)">
        <details><summary>如何把新遊戲加進來？</summary>
          <ol>
            <li>在 <code>GAME_LIST</code> 陣列中新增一個物件（可複製現有範例）。</li>
            <li>把 <code>url</code> 指向你的遊戲資料夾，例如 <code>games/my-game/</code>。</li>
            <li>將遊戲放到此專案的對應資料夾並推到 GitHub。</li>
            <li>到「Settings → Pages」檢查 Branch 設為 <code>main</code>，資料夾選 <code>/(root)</code> 或 <code>/docs</code>。</li>
          </ol>
        </details>`;
      modal.showModal();
    }

    function render(){
      const kw=state.q;
      let list=GAME_LIST.slice();
      if(state.cats.size){ list=list.filter(g=>g.cats.some(c=>state.cats.has(c))); }
      if(state.grade!=='all'){ list=list.filter(g=>g.grade===state.grade); }
      if(kw){ list=list.filter(g=> g.name.toLowerCase().includes(kw) || g.desc.toLowerCase().includes(kw) || (g.tags&&g.tags.join(' ').toLowerCase().includes(kw)) ); }
      if(state.sort==='recent'){ list.sort((a,b)=>(b.updatedAt||"").localeCompare(a.updatedAt||"")); }
      else if(state.sort==='popular'){ list.sort((a,b)=>(b.hot||0)-(a.hot||0)); }
      else{ list.sort((a,b)=>a.name.localeCompare(b.name,'zh-Hant')); }

      $grid.innerHTML="";
      if(!list.length){ $empty.hidden=false; return; }
      $empty.hidden=true;
      for(const g of list){
        const card=document.createElement('article');
        card.className='card';
        card.innerHTML=`
          <div class="thumb" role="img" aria-label="${g.name} 圖像">
            ${pickIcon(g.cats)}
            <span class="badge">${g.cats.map(c=>catName(c)).join(' · ')}</span>
          </div>
          <div class="body">
            <div class="title">${g.name}</div>
            <div class="meta">更新：${formatDate(g.updatedAt)} · 適用：${gradeName(g.grade)}</div>
            <p>${g.desc}</p>
            <div class="tags">${(g.tags||[]).map(t=>`<span class="tag">${t}</span>`).join('')}</div>
          </div>
          <div class="actions">
            <a class="btn" href="${g.url}" target="_blank" rel="noopener" aria-label="開始遊戲：${g.name}">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M8 5v14l11-7-11-7z" fill="currentColor"/></svg>
              開始遊戲
            </a>
            <button class="btn secondary" aria-label="更多資訊：${g.name}" data-id="${g.id}">詳細資訊</button>
          </div>`;
        card.querySelector('.btn.secondary').addEventListener('click',()=>openModal(g));
        $grid.appendChild(card);
      }
    }

    const params=new URLSearchParams(location.search);
    const $qEl=document.getElementById('q');
    const initQ=params.get('q'); if(initQ){ $qEl.value=initQ; state.q=initQ.toLowerCase(); }
    const initCat=params.getAll('cat'); if(initCat.length){ document.querySelectorAll('.chip').forEach(chip=>{ if(initCat.includes(chip.dataset.cat)){ chip.setAttribute('aria-pressed','true'); state.cats.add(chip.dataset.cat); } }); }
    const initGrade=params.get('grade'); if(initGrade){ $grade.value=initGrade; state.grade=initGrade; }
    const initSort=params.get('sort'); if(initSort){ $sort.value=initSort; state.sort=initSort; }

    render();
    window.addEventListener('keydown',(e)=>{
      if(e.key==='/' && document.activeElement!==$q){ e.preventDefault(); $q.focus(); }
      if(e.key==='Escape' && document.activeElement===$q){ $q.value=''; state.q=''; render(); }
      if(e.key==='Enter' && document.activeElement===$q){ e.preventDefault(); $q.blur(); }
    });
  </script>
</body>
</html>
